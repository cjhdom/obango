<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
</head>

<span id="here"><script>console.log(typeof <%-latitude%>);</script></span>

<div id="map" style="width:500px;height:650px;"></div>


<script src="//apis.daum.net/maps/maps3.js?apikey=2aa368ea23368245380c05daa21460ab"></script>
<script>
    var mapContainer = document.getElementById('map'), // 지도를 표시할 div
            mapOption = {
                center: new daum.maps.LatLng(<%-latitude%>, <%-longitude%>), // 지도의 중심좌표
                level: 2, // 지도의 확대 레벨
                mapTypeId : daum.maps.MapTypeId.ROADMAP // 지도종류
            };

    // 지도를 생성한다
    var map = new daum.maps.Map(mapContainer, mapOption);

    // 지도에 마커를 생성하고 표시한다
    var customOverlay = new daum.maps.CustomOverlay({
        map: map,
        clickable: true,
        content: '<div class="customOverlay"><a href="#">Chart</a></div>',
        position: new daum.maps.LatLng(<%-latitude%>, <%-longitude%>),
        xAnchor: 0.5,
        yAnchor: 1,
        zIndex: 999
    });

    $.ajax({
        url: 'http://172.30.1.3:3000/fetch/circle?longitude=<%-longitude%>&latitude=<%-latitude%>',
        type: 'get',
        success: function (data) {
            if (data) {
                if (data.ok) {
                    //var markers = (JSON.parse(data)).results;
                    var markers = data.results;

                    markers.forEach(function (marker) {
                        new daum.maps.Marker({
                            position: new daum.maps.LatLng(marker.obj.loc.latitude, marker.obj.loc.longitude), // 마커의 좌표
                            map: map // 마커를 표시할 지도 객체
                        });
                    });
                }
            }
        },
        error: function(res) {
            console.log(JSON.stringify(res));
        }
    });

</script>

<body>

</body>
</html>